// Generated by CoffeeScript 1.3.3
(function(){var e,t,n,r,i,s,o;e=jQuery,e(document).ready(function(){return n()}),window.onresize=function(e){return s(),r()},n=function(){return s(),r(),i()},t=window.History,o="http://"+top.location.host.toString(),e(document).delegate('a[href="/listen"], a[href="/directory"], a[href="/settings"], a[href="/help"]',"click",function(n){var r;return n.preventDefault(),r=t.getState(),console.log(r),t.pushState({},"",e(n.currentTarget).attr("href"))}),t.Adapter.bind(window,"statechange",function(){var r;r=t.getState(),t.log(r.data,r.title,r.url);if(r.hash==="/listen")return e.ajax({type:"POST",url:"/listen",success:function(t){return e(".hark-container").html(t),n()}});if(r.hash==="/directory")return e.ajax({type:"POST",url:"/directory",success:function(t){return e(".hark-container").html(t),n()}});if(r.hash==="/settings")return e.ajax({type:"POST",url:"/settings",success:function(t){return e(".hark-container").html(t),n()}});if(r.hash==="/help")return e.ajax({type:"POST",url:"/help",success:function(t){return e(".hark-container").html(t),n()}})}),e(document).delegate(".current-item, .current-feed","click",function(t){var r;t.preventDefault();if(!e(t.currentTarget).is(".blank"))return r={feedID:e(this).attr("href").split("/")[3]},e.ajax({type:"POST",data:r,url:"/listen/podcast/"+r.feedID,success:function(t){return e(".primary").html(t),n()}});console.log("blank")}),s=function(){var t,n,r;return n=e(window).width(),t=e(window).height(),r=e(".sidebar"),e(".sidebar").css("height",t-171)},r=function(){var t,n,r;return n=e(window).width(),t=e(window).height(),r=e(".primary"),e(".primary").css("height",t-171)},e(document).delegate(".categories li:not(.safe), .subscriptions li:not(.safe), .currently-playing li:not(.heading), .choose-settings li:not(.safe), .questions li:not(.safe)","hover",function(t){if(t.type==="mouseenter")return e(".hover-er").css("top",e(t.currentTarget).offset().top+0).css("opacity","100").css("height",e(t.currentTarget).height());if(!e(t.currentTarget).children(".sidebar-expander").is(".expanded"))return e(".hover-er").css("opacity","0")}),i=function(){return e(".moment").each(function(t){return e(this).attr("data-date",e(this).text()),e(this).text(moment(e(this).text()).fromNow())})},e(document).delegate(".act-add","click",function(t){return e(".add-feed-container").toggle()}),e(".add-feed").live("keypress",function(t){var r;if(t.which===13)return r={url:e(t.currentTarget).val()},e.ajax({type:"POST",url:"/listen/add",data:r,success:function(t){return e(".hark-container").html(t),e(".add-feed").val(""),e(".add-feed-container").hide(),n()}})}),e(document).delegate(".act-update","click",function(t){return t.preventDefault(),e(".act-update a").text("Updating..."),e.ajax({type:"POST",url:"/listen/update",success:function(t){return e(".act-update a").text("Update"),e(".primary").html(t),n()}})}),e(document).delegate(".allFeeds a","click",function(t){return t.preventDefault(),e.ajax({type:"POST",url:"/listen/podcast/all",success:function(t){return e(".primary").html(t),n()}})}),e(document).delegate(".loadFeed, .loadFeedFromItem","click",function(t){var r;return t.preventDefault(),r={feedID:e(this).attr("href").split("/")[3]},e.ajax({type:"POST",data:r,url:"/listen/podcast/"+r.feedID,success:function(t){return e(".primary").html(t),n()}})}),e(document).delegate(".sidebar-expander","click",function(t){return e(t.currentTarget).is(".expanded")?(e(t.currentTarget).parent().animate({height:"46px"},300),e(".hover-er").animate({height:"46px"},80),e(t.currentTarget).next().removeClass("undocked").fadeOut(300),e(t.currentTarget).parent().removeClass("active"),e(t.currentTarget).removeClass("expanded")):(e(".sidebar-action-edit-input").hide(),e(t.currentTarget).parent().animate({height:"112px"},300).css("overflow","visible"),e(".hover-er").animate({height:"102px"},80),e(t.currentTarget).next().addClass("undocked").fadeIn(300),e(t.currentTarget).parent().addClass("active"),e(t.currentTarget).addClass("expanded"))}),e(document).delegate(".sidebar-action-edit","click",function(t){return t.preventDefault(),e(".sidebar-action-edit-input").val(""),e(".sidebar-action-edit-input").fadeIn(300),e(".sidebar-action-edit-input").val(e(t.currentTarget).parent().siblings(".loadFeed").text())}),e(".sidebar-action-edit-input").live("keypress",function(t){var r;if(t.which===13)return r={feedID:e(this).prev().attr("href").split("/")[3],feedName:e(this).val()},console.log(r),e.ajax({type:"POST",data:r,url:"/listen/edit/"+r.feedID,success:function(t){return e(".hark-container").html(t),n()}})}),e(document).delegate(".sidebar-action-remove","click",function(t){var r;return t.preventDefault(),r={feedID:e(t.currentTarget).attr("href").split("/")[3]},e.ajax({type:"POST",data:r,url:"/listen/remove/"+r.feedID,success:function(t){return console.log(t),e(".hark-container").html(t),n()}})}),e(document).delegate(".podcast-item:not(.selected)","click",function(t){return e(".selected").children(".podcastDescription").fadeOut(500),e(".podcast-item").removeClass("selected"),e(t.currentTarget).addClass("selected"),e(".act-listen, .act-mark, .act-read, .act-source, .act-download").removeClass("inactive").addClass("active")}),e(document).delegate(".selected","click",function(t){return e(".selected").children(".podcastDescription").fadeOut(500),e(t.currentTarget).removeClass("selected"),e(".act-listen, .act-mark, .act-read, .act-source, .act-download").removeClass("active").addClass("inactive")}),e(document).delegate(".item-actions-listen","click",function(e){return console.log("hi")}),e(document).delegate(".act-read.active","click",function(t){return e(".selected").children(".podcastDescription").toggle(500),!1}),e(document).delegate(".act-source.active","click",function(t){return window.open(e(".selected").attr("data-source"),"_newtab")}),e(document).delegate(".act-download.active","click",function(t){return window.open(e(".selected").attr("data-file"),"_newtab")}),e(document).delegate(".act-sorting","click",function(t){return console.log("hi"),e(".act-sorting ul").toggle()}),e(document).delegate(".podcast-title a","hover",function(t){if(t.type!=="mouseenter")return e(t.currentTarget).animate({"margin-top":0},1e3,"linear");if(e(t.currentTarget).height()>e(t.currentTarget).parent().height())return e(t.currentTarget).animate({"margin-top":e(t.currentTarget).parent().height()-e(t.currentTarget).height()},1e3)}),e(document).delegate(".directory-feed-subscribe","click",function(t){return t.preventDefault(),console.log(e(t.currentTarget).attr("href")),e.ajax({type:"POST",url:e(t.currentTarget).attr("href"),success:function(e){return console.log("?")}})}),e(document).delegate(".category a:not(.loadAll)","click",function(t){return t.preventDefault(),e.ajax({type:"POST",url:e(this).attr("href"),data:e(this).attr("href"),success:function(t){return e(".directory-main").html(t),n()}})}).delegate(".category a.loadAll","click",function(t){return t.preventDefault(),e.ajax({type:"POST",url:e(this).attr("href"),data:e(this).attr("href"),success:function(t){return e(".hark-container").html(t),n()}})})}).call(this);